<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IoT-B2: Wifi ESP32</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">IoT-B2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('wifi.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Wifi ESP32 </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="howWiFi"></a>
Comment ça marche ?</h2>
<p>Il existe plusieurs façons différentes d'initialiser le mode WiFi d'un ESP32.</p><ul>
<li>Les terminaux qui se connectent aux réseaux WiFi proposés par des Access Points sont appelés des stations (mode WIFI_STA). <div class="image">
<img src="ESP32-Station-Mode.png" alt=""/>
</div>
</li>
<li>Les terminaux peuvent fournir un point d'accès ou Access Point (WIFI-AP) et se comporter comme un hub pour une ou plusieurs stations. Classiquement un Access Point est connecté à un réseau filaire et intégre un routeur pour donner accès à internet via le WiFi. Chaque Access Point fournit un SSID (Service Set IDentifier) visible et accessible pour les stations (autres terminaux comme un téléphone mobile ou un ordinateur). <div class="image">
<img src="ESP32-Access-Point-Mode.png" alt=""/>
</div>
</li>
<li>Les terminaux peuvent également activer les 2 modes de fonctionnement en même temps (Station et Access Point, en mode WIFI_AP_STA).</li>
</ul>
<h2><a class="anchor" id="foncWiFi"></a>
Principales fonctions</h2>
<p>Les principales fonctions de la librairie ESP8266WiFi sont :</p><ul>
<li>Wifi.mode(&lt;MODE&gt;) qui prend en paramètre un des modes suivants :<ul>
<li>WIFI_STA quand la carte veut accéder à une réseau WiFi en mode client</li>
<li>WIFI_AP quand la carte veut être un point d'accès (être un SSID)</li>
<li>WIFI_AP_STA pour faire les 2 à la fois</li>
<li>WIFI_OFF comme son nom l'indique</li>
</ul>
</li>
<li>WiFi.begin("nom-du-SSID", "mot-de-passe")</li>
<li>WiFi.status() qui vous retourne<ul>
<li>0 : WL_IDLE_STATUS when Wi-Fi is in process of changing between statuses</li>
<li>1 : WL_NO_SSID_AVAIL quand le SSID indiqué n'est pas atteingnable</li>
<li>3 : WL_CONNECTED quand la connexion a été établi</li>
<li>4 : WL_CONNECT_FAILED si le mot de passe du SSID est incorrect</li>
<li>6 : WL_DISCONNECTED si le module n'est pas configuration en mode Station</li>
</ul>
</li>
<li>WiFi.localIP() en mode WIFI_STA affiche l'adresse IP de la carte</li>
<li>WiFi.scanNetworks() vous permet de scanner et récupérer les informations sur les SSID à portée.</li>
</ul>
<p>Les classes WiFiClient et WiFiServer vous permettent de manipuler les communications en tant que client ou server.</p>
<h2><a class="anchor" id="TPWIfi"></a>
Prise en main</h2>
<p>Pour prendre en main le Wifi sur votre carte, je vous invite à découvrir les fichiers exemples suivants :</p><ol type="1">
<li><b>Exemples/WiFi/WiFiScan</b> scanne les réseaux WiFi (Access Points) visibles par la carte qui est en mode STAtion et de les liste sur le moniteur de sortie.</li>
<li><b>Exemples/WiFi/WiFiClient</b> permet à la carte d'accéder à un réseau WiFi en mode STAtion; la sélection du réseau WiFi se fait en remplissant les valeurs de STASSID et STAPSK. Une fois connecté la carte créé un client WiFi TCP et va requéter un serveur et afficher les informations qu'elle récupère.</li>
<li><b>Exemples/WiFi/WiFiMulti</b> permet de lister plusieurs Access Points auquels vous souhaitez/pouvez accéder. Si le premier SSID n'est pas disponible alors la carte tente de se connecter au suivant ... Cette fonctionnalité est proposée par la classe WiFiMulti. Vous pouvez ainsi configurer les réseaux WiFi de l'école, de chez vous et celui de votre téléphone, par exemple. A noter qu'il faut bien penser à appeler la méthode wifiMulti.run() dans la loop() pour surveiller l'état de la connexion à chaque itération et faire le nécessaire si besoin est.</li>
<li><b>Exemples/WiFi/WiFiClientBasic</b> se connecte en mode STA à un SSID via WiFiMulti et réalise une requête à un serveur HTTP, récupère la réponse du serveur et l'affiche sur le moniteur série; et recommence 10 seconds après.</li>
<li><b>Exemples/WiFi/WiFiAccessPoint</b> permet de créer un point d'accès WiFi. En lançant cet exemple la carte crée un réseau WiFi avec le nom renseigné dans ssid; vous pourrez le voir depuis votre ordinateur ou votre téléphone, et y accéder en renseignant le mot de passe indiqué dans password. Une fois connecté, vous pourrez vous rendre sur l'adresse <a href="http://192.168.4.1">http://192.168.4.1</a> depuis un navigateur web et la carte vous renverra le code HTML présent dans la méthode <a class="el" href="_my_web_server_8h.html#a8427468f39342a1990703e9f5ce7fd29">handleRoot()</a> que le serveur appelle pour la route "/".</li>
<li><b>Exemples/DNSServer/CaptivePortal</b> démarre la carte en mode Access Point et répond à toutes les requêtes en retournant une page web. Ainsi dès qu'un terminal (ordinateur, téléphone ...) se connecte au SSID il est routé sur le portail captif sur la base de cette page web.</li>
</ol>
<p>Je vous invite à installer la librairie WiFiManager et à tester l'exemple fourni :</p><ol type="1">
<li>Dans le menu "Outils/Gérer les bibliothèques", renseigner "captive" dans la barre de recherche et installez la dernière version de WiFiManager dy Tablatronix.</li>
<li>Dans tester l'exemple qui se trouve sur <b>Exemple/WiFiManager/Basic</b>.</li>
</ol>
<h2><a class="anchor" id="exemple"></a>
Exemple</h2>
<p>Dans cet exemple, l'objet est utilisé avec les 2 modes Access Point et Station :</p><ul>
<li>Access Point pour que l'utilisateur puisse accéder à un serveur web proposé par la carte</li>
<li>Station pour se connecter à un Access Point pour accéder au réseau externe (internet).</li>
</ul>
<p>Je peux ajouter un serveur DNS pour réaliser un portail captif ... </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Généré par <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
